Proceeding with code...

Using config file: configs/shearnet/forklike/superbit_psf/high_noise.yaml

==================================================
Training Configuration
==================================================

dataset:
  samples: 100000
  psf_sigma: 0.25
  exp: superbit
  nse_sd: 12.719674
  seed: 42
  stamp_size: 53
  pixel_size: 0.141
  apply_psf_shear: False
  psf_shear_range: 0.05

model:
  process_psf: True
  type: fork-like
  galaxy: {'type': 'research_backed'}
  psf: {'type': 'forklens_psf'}

training:
  epochs: 300
  batch_size: 128
  learning_rate: 0.001
  weight_decay: 0.0001
  patience: 25
  val_split: 0.2
  eval_interval: 1

output:
  save_path: /home/adfield/ShearNet/model_checkpoint
  plot_path: /home/adfield/ShearNet/plots
  model_name: FIRST_const_sigma+flux_nse_sd_12_type_exp

plotting:
  plot: True
==================================================

Running on device: cuda:0
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 19418 x 19418, which requires 8.43 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 44354 x 44354, which requires 43.97 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 9344 x 9344, which requires 1.95 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 9484 x 9484, which requires 2.01 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 20796 x 20796, which requires 9.67 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 17336 x 17336, which requires 6.72 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 22072 x 22072, which requires 10.89 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 10632 x 10632, which requires 2.53 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 74518 x 74518, which requires 124.12 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 22070 x 22070, which requires 10.89 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 72870 x 72870, which requires 118.69 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 39136 x 39136, which requires 34.23 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 77374 x 77374, which requires 133.81 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 10974 x 10974, which requires 2.69 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 20790 x 20790, which requires 9.66 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 99802 x 99802, which requires 222.63 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 10652 x 10652, which requires 2.54 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 16620 x 16620, which requires 6.17 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 8972 x 8972, which requires 1.80 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 36760 x 36760, which requires 30.20 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 92072 x 92072, which requires 189.48 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 20456 x 20456, which requires 9.35 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 10546 x 10546, which requires 2.49 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
Shape of train PSF images: (100000, 53, 53)
Shape of train images: (100000, 53, 53)
Shape of train labels: (100000, 4)

Training configuration saved to: /home/adfield/ShearNet/plots/FIRST_const_sigma+flux_nse_sd_12_type_exp/training_config.yaml
Model architecture saved to: /home/adfield/ShearNet/plots/FIRST_const_sigma+flux_nse_sd_12_type_exp/architecture.py
Epoch 1/300
Validation Loss: 3.6506e+03
New best validation loss: 3.6506e+03
Epoch 2/300
Validation Loss: 3.1994e+03
New best validation loss: 3.1994e+03
Epoch 3/300
Validation Loss: 2.2209e+03
New best validation loss: 2.2209e+03
Epoch 4/300
Validation Loss: 1.0871e+03
New best validation loss: 1.0871e+03
Epoch 5/300
Validation Loss: 1.1061e+03
No improvement in validation loss. Patience: 1/25
Epoch 6/300
Validation Loss: 4.2676e+02
New best validation loss: 4.2676e+02
Epoch 7/300
Validation Loss: 4.6706e+02
No improvement in validation loss. Patience: 1/25
Epoch 8/300
Validation Loss: 2.1789e+02
New best validation loss: 2.1789e+02
Epoch 9/300
Validation Loss: 4.1423e+02
No improvement in validation loss. Patience: 1/25
Epoch 10/300
Validation Loss: 8.1712e+01
New best validation loss: 8.1712e+01
Epoch 11/300
Validation Loss: 3.0517e+01
New best validation loss: 3.0517e+01
Epoch 12/300
Validation Loss: 1.2478e+02
No improvement in validation loss. Patience: 1/25
Epoch 13/300
Validation Loss: 2.1926e+01
New best validation loss: 2.1926e+01
Epoch 14/300
Validation Loss: 1.5486e+02
No improvement in validation loss. Patience: 1/25
Epoch 15/300
Validation Loss: 6.1970e+01
No improvement in validation loss. Patience: 2/25
Epoch 16/300
Validation Loss: 1.3578e+02
No improvement in validation loss. Patience: 3/25
Epoch 17/300
Validation Loss: 2.4755e+01
No improvement in validation loss. Patience: 4/25
Epoch 18/300
Validation Loss: 8.6171e+00
New best validation loss: 8.6171e+00
Epoch 19/300
Validation Loss: 8.3934e+00
New best validation loss: 8.3934e+00
Epoch 20/300
Validation Loss: 3.1893e+00
New best validation loss: 3.1893e+00
Epoch 21/300
Validation Loss: 3.3900e+00
No improvement in validation loss. Patience: 1/25
Epoch 22/300
Validation Loss: 7.3202e+01
No improvement in validation loss. Patience: 2/25
Epoch 23/300
Validation Loss: 1.8070e+02
No improvement in validation loss. Patience: 3/25
Epoch 24/300
Validation Loss: 1.7471e+01
No improvement in validation loss. Patience: 4/25
Epoch 25/300
Validation Loss: 2.2448e+01
No improvement in validation loss. Patience: 5/25
Epoch 26/300
Validation Loss: 8.0665e+01
No improvement in validation loss. Patience: 6/25
Epoch 27/300
Validation Loss: 2.4583e+02
No improvement in validation loss. Patience: 7/25
Epoch 28/300
Validation Loss: 4.7768e+02
No improvement in validation loss. Patience: 8/25
Epoch 29/300
Validation Loss: 1.1513e+01
No improvement in validation loss. Patience: 9/25
Epoch 30/300
Validation Loss: 2.5858e+01
No improvement in validation loss. Patience: 10/25
Epoch 31/300
Validation Loss: 1.1693e+02
No improvement in validation loss. Patience: 11/25
Epoch 32/300
Validation Loss: 3.3524e+01
No improvement in validation loss. Patience: 12/25
Epoch 33/300
Validation Loss: 1.7312e+01
No improvement in validation loss. Patience: 13/25
Epoch 34/300
Validation Loss: 3.3029e+00
No improvement in validation loss. Patience: 14/25
Epoch 35/300
Validation Loss: 1.3452e+01
No improvement in validation loss. Patience: 15/25
Epoch 36/300
Validation Loss: 1.7803e+01
No improvement in validation loss. Patience: 16/25
Epoch 37/300
Validation Loss: 1.3926e+01
No improvement in validation loss. Patience: 17/25
Epoch 38/300
Validation Loss: 1.3801e+01
No improvement in validation loss. Patience: 18/25
Epoch 39/300
Validation Loss: 1.9809e+00
New best validation loss: 1.9809e+00
Epoch 40/300
Validation Loss: 9.0283e+01
No improvement in validation loss. Patience: 1/25
Epoch 41/300
Validation Loss: 2.7294e+00
No improvement in validation loss. Patience: 2/25
Epoch 42/300
Validation Loss: 9.7491e-01
New best validation loss: 9.7491e-01
Epoch 43/300
Validation Loss: 1.0734e+01
No improvement in validation loss. Patience: 1/25
Epoch 44/300
Validation Loss: 9.3383e-01
New best validation loss: 9.3383e-01
Epoch 45/300
Validation Loss: 1.6913e+00
No improvement in validation loss. Patience: 1/25
Epoch 46/300
Validation Loss: 1.8185e+00
No improvement in validation loss. Patience: 2/25
Epoch 47/300
Validation Loss: 2.3177e+02
No improvement in validation loss. Patience: 3/25
Epoch 48/300
Validation Loss: 2.1130e+01
No improvement in validation loss. Patience: 4/25
Epoch 49/300
Validation Loss: 4.2075e+00
No improvement in validation loss. Patience: 5/25
Epoch 50/300
Validation Loss: 2.9392e+01
No improvement in validation loss. Patience: 6/25
Epoch 51/300
Validation Loss: 1.1440e+01
No improvement in validation loss. Patience: 7/25
Epoch 52/300
Validation Loss: 1.4275e+00
No improvement in validation loss. Patience: 8/25
Epoch 53/300
Validation Loss: 3.4991e+01
No improvement in validation loss. Patience: 9/25
Epoch 54/300
Validation Loss: 1.7092e+03
No improvement in validation loss. Patience: 10/25
Epoch 55/300
Validation Loss: 1.1441e+02
No improvement in validation loss. Patience: 11/25
Epoch 56/300
Validation Loss: 2.9140e+00
No improvement in validation loss. Patience: 12/25
Epoch 57/300
Validation Loss: 1.2491e+01
No improvement in validation loss. Patience: 13/25
Epoch 58/300
Validation Loss: 1.4565e+01
No improvement in validation loss. Patience: 14/25
Epoch 59/300
Validation Loss: 5.2581e+01
No improvement in validation loss. Patience: 15/25
Epoch 60/300
Validation Loss: 1.6248e+01
No improvement in validation loss. Patience: 16/25
Epoch 61/300
Validation Loss: 1.0865e+01
No improvement in validation loss. Patience: 17/25
Epoch 62/300
Validation Loss: 6.2669e+01
No improvement in validation loss. Patience: 18/25
Epoch 63/300
Validation Loss: 3.0366e+02
No improvement in validation loss. Patience: 19/25
Epoch 64/300
Validation Loss: 6.7251e+01
No improvement in validation loss. Patience: 20/25
Epoch 65/300
Validation Loss: 5.9205e+00
No improvement in validation loss. Patience: 21/25
Epoch 66/300
Validation Loss: 5.7503e+02
No improvement in validation loss. Patience: 22/25
Epoch 67/300
Validation Loss: 3.4971e+02
No improvement in validation loss. Patience: 23/25
Epoch 68/300
Validation Loss: 4.8309e-01
New best validation loss: 4.8309e-01
Epoch 69/300
Validation Loss: 4.4278e+00
No improvement in validation loss. Patience: 1/25
Epoch 70/300
Validation Loss: 6.1544e+01
No improvement in validation loss. Patience: 2/25
Epoch 71/300
Validation Loss: 2.9067e+01
No improvement in validation loss. Patience: 3/25
Epoch 72/300
Validation Loss: 9.0225e+01
No improvement in validation loss. Patience: 4/25
Epoch 73/300
Validation Loss: 1.4924e+01
No improvement in validation loss. Patience: 5/25
Epoch 74/300
Validation Loss: 1.4679e+02
No improvement in validation loss. Patience: 6/25
Epoch 75/300
Validation Loss: 1.0683e+03
No improvement in validation loss. Patience: 7/25
Epoch 76/300
Validation Loss: 3.2946e+02
No improvement in validation loss. Patience: 8/25
Epoch 77/300
Validation Loss: 1.4078e+02
No improvement in validation loss. Patience: 9/25
Epoch 78/300
Validation Loss: 3.6899e+01
No improvement in validation loss. Patience: 10/25
Epoch 79/300
Validation Loss: 8.2298e+00
No improvement in validation loss. Patience: 11/25
Epoch 80/300
Validation Loss: 1.4129e+02
No improvement in validation loss. Patience: 12/25
Epoch 81/300
Validation Loss: 8.8993e+00
No improvement in validation loss. Patience: 13/25
Epoch 82/300
Validation Loss: 7.1597e+00
No improvement in validation loss. Patience: 14/25
Epoch 83/300
Validation Loss: 2.4728e+02
No improvement in validation loss. Patience: 15/25
Epoch 84/300
Validation Loss: 8.8964e+00
No improvement in validation loss. Patience: 16/25
Epoch 85/300
Validation Loss: 4.0369e+00
No improvement in validation loss. Patience: 17/25
Epoch 86/300
Validation Loss: 4.6384e+00
No improvement in validation loss. Patience: 18/25
Epoch 87/300
Validation Loss: 5.1519e+01
No improvement in validation loss. Patience: 19/25
Epoch 88/300
Validation Loss: 2.0013e+00
No improvement in validation loss. Patience: 20/25
Epoch 89/300
Validation Loss: 1.9403e+01
No improvement in validation loss. Patience: 21/25
Epoch 90/300
Validation Loss: 8.2416e+00
No improvement in validation loss. Patience: 22/25
Epoch 91/300
Validation Loss: 7.4624e+01
No improvement in validation loss. Patience: 23/25
Epoch 92/300
Validation Loss: 1.9479e+02
No improvement in validation loss. Patience: 24/25
Epoch 93/300
Validation Loss: 7.3756e+00
No improvement in validation loss. Patience: 25/25
Early stopping triggered.
Checkpoint saved at step 93.
Plotting learning curve...
Saving training and validation loss...

[1mLoading model config from: /home/adfield/ShearNet/plots/FIRST_const_sigma+flux_nse_sd_12_type_exp/training_config.yaml[0m

==================================================
Evaluation Configuration
==================================================

evaluation:
  test_samples: 50000
  seed: 58

model:
  process_psf: True
  type: fork-like
  galaxy: {'type': 'research_backed'}
  psf: {'type': 'forklens_psf'}

plotting:
  plot: True

comparison:
  mcal: True
  ngmix: True
  psf_model: gauss
  gal_model: gauss
==================================================


[1m==================================================
Generating Test Dataset
==================================================[0m
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 21388 x 21388, which requires 10.22 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 8822 x 8822, which requires 1.74 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 20542 x 20542, which requires 9.43 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 5253040 x 5253040, which requires 616783.56 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 21678 x 21678, which requires 10.50 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 21460 x 21460, which requires 10.29 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 9270 x 9270, which requires 1.92 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 8870 x 8870, which requires 1.76 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 9860 x 9860, which requires 2.17 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 9900 x 9900, which requires 2.19 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
Shape of test galaxy images: (50000, 53, 53)
Shape of test PSF images: (50000, 53, 53)
Shape of test labels: (50000, 4)
SNR range: [-4.33, 4.58], mean: 0.00

[1m==================================================
Loading Model
==================================================[0m
Found 1 matching checkpoint(s):
  1. FIRST_const_sigma+flux_nse_sd_12_type_exp93

[92mLoading checkpoint from: /home/adfield/ShearNet/model_checkpoint/FIRST_const_sigma+flux_nse_sd_12_type_exp93[0m
[92m‚úì Model checkpoint loaded successfully[0m

[1m==================================================
Evaluating Neural Network
==================================================[0m

[1m=== Combined Metrics (ShearNet) ===[0m
Mean Squared Error (MSE) from ShearNet: [1m[93m1.881641e+10[0m
Average Bias from ShearNet: [1m[93m9.711841e+04[0m
Time taken: [1m[96m9.34 seconds[0m

=== Per-Label Metrics ===
             g1: MSE = 2.861209e+04, Bias = +2.228506e+02
             g2: MSE = 1.736325e+04, Bias = +5.453545e+01
  g1g2_combined: MSE = 2.298766e+04, Bias = +1.386931e+02
          sigma: MSE = 8.315647e+04, Bias = +3.940856e+02
           flux: MSE = 7.526550e+10, Bias = +3.878023e+05


[1m==================================================
Evaluating Comparison Methods
==================================================[0m
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
[NaN Filter] Removed 9949 rows with NaNs in predictions.

[1m=== Combined Metrics (NGmix) ===[0m
Mean Squared Error (MSE) from NGmix: [1m[93m4.989554e+07[0m
Average Bias from NGmix: [1m[93m-2.043455e+02[0m
Time taken: [1m[96m723.08 seconds[0m

=== Per-Label Metrics ===
             g1: MSE = 4.119736e-02, Bias = +2.748456e-03
             g2: MSE = 4.093693e-02, Bias = +4.238380e-04
  g1g2_combined: MSE = 4.106715e-02, Bias = +1.586147e-03
          sigma: MSE = 8.356232e+01, Bias = +9.272746e+00
           flux: MSE = 1.995821e+08, Bias = -8.266577e+02


=== Combined Metrics (Moment-Based Approach) ===
Mean Squared Error (MSE) from MOM: 5.745672e+06
Average Bias from MOM: 1.521738e+01
Time taken: 450.88 seconds

=== Per-Label Metrics ===
             g1: MSE = 8.750201e+06, Bias = +1.965445e+01
             g2: MSE = 2.741143e+06, Bias = +1.078030e+01
  g1g2_combined: MSE = 5.745672e+06, Bias = +1.521738e+01


[1m==================================================
Calculating Response Matrices
==================================================[0m

[1mCalculating Response Matrix...[0m
Extracted 50000 galaxies with sheared images
Shear step: ¬±0.01

[1mResponse Matrix (averaged over 50000 galaxies):[0m
[96mR = [[0.000000, 0.000000],[0m
[96m     [0.000000, 0.000000]][0m

Response matrix statistics:
  R_11: mean=0.000000, std=0.000000
  R_22: mean=0.000000, std=0.000000
  R_12: mean=0.000000, std=0.000000
  R_21: mean=0.000000, std=0.000000

[1mCalculating NGmix Response Matrix...[0m
Running NGmix on e1_positive images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e1_negative images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e2_positive images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e2_negative images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Valid galaxies after removing NaNs: 50000/50000

[1mNGmix Response Matrix (averaged over 50000 galaxies):[0m
[96mR = [[-0.008178, 0.004081],[0m
[96m     [-0.013663, -0.025855]][0m

[1mResponse Matrix Comparison:[0m

[96mShearNet R matrix:[0m
  [[+0.000000, +0.000000],
   [+0.000000, +0.000000]]

[96mNGmix R matrix:[0m
  [[-0.008178, +0.004081],
   [-0.013663, -0.025855]]

[93mDifference (ShearNet - NGmix):[0m
  [[+0.008178, -0.004081],
   [+0.013663, +0.025855]]

[92mResponse matrices saved to: /home/adfield/ShearNet/plots/FIRST_const_sigma+flux_nse_sd_12_type_exp/response_matrices.npz[0m

[1m==================================================
Generating Bias Calibration Datasets
==================================================[0m
Shear step: ¬±0.02
Samples per dataset: 50000

[96mDataset A: g1 = +0.02[0m
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 21030 x 21030, which requires 9.89 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 8998 x 8998, which requires 1.81 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 20192 x 20192, which requires 9.11 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 5258918 x 5258918, which requires 618164.66 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 21752 x 21752, which requires 10.58 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 21322 x 21322, which requires 10.16 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 9138 x 9138, which requires 1.87 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 8696 x 8696, which requires 1.69 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 9748 x 9748, which requires 2.12 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 10088 x 10088, which requires 2.27 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.

[96mDataset B: g1 = -0.02[0m
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 8982 x 8982, which requires 1.80 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 17190 x 17190, which requires 6.60 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 24144 x 24144, which requires 13.03 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 8680 x 8680, which requires 1.68 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 10870 x 10870, which requires 2.64 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 11062 x 11062, which requires 2.74 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 10456 x 10456, which requires 2.44 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 9990 x 9990, which requires 2.23 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 79526 x 79526, which requires 141.36 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 82216 x 82216, which requires 151.09 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.

[96mDataset C: g2 = +0.02[0m
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 86350 x 86350, which requires 166.66 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 17354 x 17354, which requires 6.73 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 9670 x 9670, which requires 2.09 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 21984 x 21984, which requires 10.80 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 23986 x 23986, which requires 12.86 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 9674 x 9674, which requires 2.09 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 18010 x 18010, which requires 7.25 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.

[96mDataset D: g2 = -0.02[0m
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 9296 x 9296, which requires 1.93 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 10106 x 10106, which requires 2.28 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 10876 x 10876, which requires 2.64 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 18990 x 18990, which requires 8.06 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 8380 x 8380, which requires 1.57 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 9494 x 9494, which requires 2.01 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.
GalSim error drawing clean galaxy: drawFFT requires an FFT that is too large.
The required FFT size would be 76352 x 76352, which requires 130.30 GB of memory.
If you can handle the large FFT, you may update gsparams.maximum_fft_size.

[92m‚úì Generated 4 bias datasets with PSF images[0m

[1m==================================================
Calculating Bias Calibration
==================================================[0m

[1m[93mShearNet Bias Calibration[0m

[1m======================================================================
CALCULATING MULTIPLICATIVE AND ADDITIVE BIAS
======================================================================[0m
True shear: ¬±0.02
Response perturbation: ¬±0.01

[1m[96m--- Component 1 (g1) ---[0m

Dataset A (g1 = +0.02):

[1mCalculating Response Matrix...[0m
Extracted 50000 galaxies with sheared images
Shear step: ¬±0.01

[1mResponse Matrix (averaged over 50000 galaxies):[0m
[96mR = [[0.000000, 0.000000],[0m
[96m     [0.000000, 0.000000]][0m

Response matrix statistics:
  R_11: mean=0.000000, std=0.000000
  R_22: mean=0.000000, std=0.000000
  R_12: mean=0.000000, std=0.000000
  R_21: mean=0.000000, std=0.000000

Dataset B (g1 = -0.02):

[1mCalculating Response Matrix...[0m
Extracted 50000 galaxies with sheared images
Shear step: ¬±0.01

[1mResponse Matrix (averaged over 50000 galaxies):[0m
[96mR = [[0.000000, 0.000000],[0m
[96m     [0.000000, 0.000000]][0m

Response matrix statistics:
  R_11: mean=0.000000, std=0.000000
  R_22: mean=0.000000, std=0.000000
  R_12: mean=0.000000, std=0.000000
  R_21: mean=0.000000, std=0.000000

[96mSummary for g1:[0m
  Dataset A: ‚ü®e‚ÇÅ‚ü© = +5.230740, ‚ü®R‚ÇÅ‚ÇÅ‚ü© = 0.000000, Œ≥‚ÇÅ·µâÀ¢·µó = +inf
  Dataset B: ‚ü®e‚ÇÅ‚ü© = +5.230383, ‚ü®R‚ÇÅ‚ÇÅ‚ü© = 0.000000, Œ≥‚ÇÅ·µâÀ¢·µó = +inf

[1m[96m--- Component 2 (g2) ---[0m

Dataset C (g2 = +0.02):

[1mCalculating Response Matrix...[0m
Extracted 50000 galaxies with sheared images
Shear step: ¬±0.01

[1mResponse Matrix (averaged over 50000 galaxies):[0m
[96mR = [[0.000000, 0.000000],[0m
[96m     [0.000000, 0.000000]][0m

Response matrix statistics:
  R_11: mean=0.000000, std=0.000000
  R_22: mean=0.000000, std=0.000000
  R_12: mean=0.000000, std=0.000000
  R_21: mean=0.000000, std=0.000000

Dataset D (g2 = -0.02):

[1mCalculating Response Matrix...[0m
Extracted 50000 galaxies with sheared images
Shear step: ¬±0.01

[1mResponse Matrix (averaged over 50000 galaxies):[0m
[96mR = [[0.000000, 0.000000],[0m
[96m     [0.000000, 0.000000]][0m

Response matrix statistics:
  R_11: mean=0.000000, std=0.000000
  R_22: mean=0.000000, std=0.000000
  R_12: mean=0.000000, std=0.000000
  R_21: mean=0.000000, std=0.000000

[96mSummary for g2:[0m
  Dataset C: ‚ü®e‚ÇÇ‚ü© = -0.817963, ‚ü®R‚ÇÇ‚ÇÇ‚ü© = 0.000000, Œ≥‚ÇÇ·µâÀ¢·µó = -inf
  Dataset D: ‚ü®e‚ÇÇ‚ü© = -0.818414, ‚ü®R‚ÇÇ‚ÇÇ‚ü© = 0.000000, Œ≥‚ÇÇ·µâÀ¢·µó = -inf

[1m======================================================================
BIAS CALIBRATION RESULTS
======================================================================[0m

[1m[93mComponent 1:[0m
[1m  m‚ÇÅ = +nan  (+nan%)[0m
[1m  c‚ÇÅ = +inf[0m

[1m[93mComponent 2:[0m
[1m  m‚ÇÇ = +nan  (+nan%)[0m
[1m  c‚ÇÇ = -inf[0m
[1m======================================================================[0m


[1m[93mNGmix Bias Calibration[0m

[1m======================================================================
CALCULATING MULTIPLICATIVE AND ADDITIVE BIAS (NGMIX)
======================================================================[0m
True shear: ¬±0.02
Response perturbation: ¬±0.01

[1m[96m--- Component 1 (g1) ---[0m

Dataset A (g1 = +0.02):

[1mCalculating NGmix Response Matrix...[0m
Running NGmix on e1_positive images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e1_negative images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e2_positive images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e2_negative images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Valid galaxies after removing NaNs: 50000/50000

[1mNGmix Response Matrix (averaged over 50000 galaxies):[0m
[96mR = [[0.013995, -0.008887],[0m
[96m     [-0.014897, -0.037724]][0m

Dataset B (g1 = -0.02):

[1mCalculating NGmix Response Matrix...[0m
Running NGmix on e1_positive images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e1_negative images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e2_positive images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e2_negative images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Valid galaxies after removing NaNs: 50000/50000

[1mNGmix Response Matrix (averaged over 50000 galaxies):[0m
[96mR = [[-0.042002, 0.009632],[0m
[96m     [0.000019, -0.007792]][0m
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96

[96mSummary for g1:[0m
  Dataset A: ‚ü®e‚ÇÅ‚ü© = +0.003544, ‚ü®R‚ÇÅ‚ÇÅ‚ü© = 0.013995, Œ≥‚ÇÅ·µâÀ¢·µó = +0.253233
  Dataset B: ‚ü®e‚ÇÅ‚ü© = +0.003033, ‚ü®R‚ÇÅ‚ÇÅ‚ü© = -0.042002, Œ≥‚ÇÅ·µâÀ¢·µó = -0.072215

[1m[96m--- Component 2 (g2) ---[0m

Dataset C (g2 = +0.02):

[1mCalculating NGmix Response Matrix...[0m
Running NGmix on e1_positive images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e1_negative images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e2_positive images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e2_negative images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Valid galaxies after removing NaNs: 50000/50000

[1mNGmix Response Matrix (averaged over 50000 galaxies):[0m
[96mR = [[0.009261, 0.018210],[0m
[96m     [0.009941, -0.020759]][0m

Dataset D (g2 = -0.02):

[1mCalculating NGmix Response Matrix...[0m
Running NGmix on e1_positive images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e1_negative images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e2_positive images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Running NGmix on e2_negative images...
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Valid galaxies after removing NaNs: 50000/50000

[1mNGmix Response Matrix (averaged over 50000 galaxies):[0m
[96mR = [[0.029218, 0.007671],[0m
[96m     [-0.022195, -0.016430]][0m
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96
Starting NGmix ML fitting: num_gal: 50000 | psf_model: gauss | gal_model: gauss | num_cores: 96

[96mSummary for g2:[0m
  Dataset C: ‚ü®e‚ÇÇ‚ü© = +0.002214, ‚ü®R‚ÇÇ‚ÇÇ‚ü© = -0.020759, Œ≥‚ÇÇ·µâÀ¢·µó = -0.106658
  Dataset D: ‚ü®e‚ÇÇ‚ü© = +0.002200, ‚ü®R‚ÇÇ‚ÇÇ‚ü© = -0.016430, Œ≥‚ÇÇ·µâÀ¢·µó = -0.133893

[1m======================================================================
BIAS CALIBRATION RESULTS (NGMIX)
======================================================================[0m

[1m[93mComponent 1:[0m
[1m  m‚ÇÅ = +7.136192  (+713.62%)[0m
[1m  c‚ÇÅ = +0.090509[0m

[1m[93mComponent 2:[0m
[1m  m‚ÇÇ = -0.319120  (-31.91%)[0m
[1m  c‚ÇÇ = -0.120276[0m
[1m======================================================================[0m


[1mBias Comparison:[0m

[96mShearNet:[0m
  m‚ÇÅ = +nan (+nan%)
  m‚ÇÇ = +nan (+nan%)

[96mNGmix:[0m
  m‚ÇÅ = +7.136192 (+713.62%)
  m‚ÇÇ = -0.319120 (-31.91%)

[93mDifference (ShearNet - NGmix):[0m
  Œîm‚ÇÅ = +nan
  Œîm‚ÇÇ = +nan

[92mBias calibration results saved to: /home/adfield/ShearNet/plots/FIRST_const_sigma+flux_nse_sd_12_type_exp/bias_calibration.npz[0m
[96mSaved parameters:[0m
  ‚Ä¢ m‚ÇÅ = +nan, c‚ÇÅ = +inf
  ‚Ä¢ m‚ÇÇ = +nan, c‚ÇÇ = -inf
  ‚Ä¢ m‚ÇÅ (NGmix) = +7.136192, c‚ÇÅ = +0.090509
  ‚Ä¢ m‚ÇÇ (NGmix) = -0.319120, c‚ÇÇ = -0.120276

[1m==================================================
Generating Plots
==================================================[0m
